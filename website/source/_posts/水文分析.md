---
title: 水文分析
mathjax: true
cover: http://image.viotbery.cloud/image-20221029203029842.png
categories: GIS实例练习
---
## 水文分析概述

水分分析主要用于帮助建立地表上的运动情况的模型（或者类似地貌的分析例如沟谷）

### 无洼地DEM生成

DEM数据应当是光滑的地形表面的模拟，但是由于误差或者一些特殊地貌导致DEM表面存在一些凹陷的区域。在进行水流方向的计算时会因此得到错误的水流方向（或不连续的水流）

因此，在进行有关水流方向的计算前，需要对DEM数据进行洼地填充得到无洼地的DEM。

生成无洼地的DEM需要按照以下步骤：

1. 提取水流方向
2. 洼地计算：根据水流方向来判断洼地
   1. 洼地提取【汇】
   2. 洼地深度计算【分水岭】-【统计最小值】-【区域填充】-【栅格计算器】
3. 洼地填充：通过洼地提取后可判断是否存在洼地，并且洼地深度可作为洼地填充的重要阈值
   1. 【填洼】
   2. 洼地填充后再进行洼地计算可能还会形成新的洼地，因此需要不断反复的进行洼地填充知道不存在洼地

#### 提取水流方向

对每一个中心栅格，对周围8个栅格进行编码，编码值为2的幂值。

使用【水文分析】-【流向】进行流向的计算，一般情况以默认参数进行分析。

<img src="../../../../../AppData/Roaming/Typora/typora-user-images/image-20221029193442741.png" alt="image-20221029193442741" style="zoom:33%;" />

#### 洼地提取

使用【汇】打开洼地工具，导入流向栅格输出为sink

> 汇是指流向栅格中流向无法被赋予八个有效值之一的一个或一组空间连接像元

<img src="http://image.viotbery.cloud/image-20221029193646599.png" alt="image-20221029193646599" style="zoom:33%;" />

#### 洼地深度计算

使用【分水岭】(ArcGis Pro中被翻译为【集水区】)工具计算洼地的贡献区域。

![image-20221029194848616](http://image.viotbery.cloud/image-20221029194848616.png)

输入流向栅格和上步得到的sink输出watersink

<img src="http://image.viotbery.cloud/image-20221029194826317.png" alt="image-20221029194826317" style="zoom:33%;" />



计算每个洼地所形成的**贡献区域的最低高程**

使用【区域分析】-【分区统计】工具，使用watersink作为区域栅格，对dem进行统计，将区域内dem值最低的赋值给各集水区

![image-20221029195320744](http://image.viotbery.cloud/image-20221029195320744.png)



计算每个洼地贡献区域出口的最低高程即**洼地出水口高程**

使用【区域分析】-【区域填充】工具，将洼地填充至分水岭边界的最小高程

![image-20221029195728903](http://image.viotbery.cloud/image-20221029195728903.png)

> 区域统计和区域填充都是用DEM的最小像元值填充当前区域，但是结果不一样，这是为什么？搞不懂

计算洼地深度

使用栅格计算器，计算zonalMin和zonalMax的插值得到洼地深度图

<img src="http://image.viotbery.cloud/image-20221029200549160.png" alt="image-20221029200549160" style="zoom: 33%;" />

通过对研究区的分析，可以确定哪些洼地是由数据误差产生的，哪些是反应自然地形的来**确定合理的填充阈值**

#### 洼地填充

以上的步骤只是为了确定是否有洼地，实际上使用填洼工具可以与与焦点流、流向、洼地、分水岭和区域填充等工具**等效的功能**来定位和填充洼地。

该工具会不断的迭代直到没有洼地为止。

【填洼】工具需要输入原始DEM，并设置Z限制。后者表示大于该值的洼地不会被填充，默认为空即填充所有洼地

### 汇流累积量

流向栅格每个像元都有1单元的水量，根据水流方向进行流动。最终稿累加的水量即为汇流累积量。汇流累积量的计算要**基于无洼地DEM**生成的水流方向

![image-20221029202400703](http://image.viotbery.cloud/image-20221029202400703.png)

使用【流量】工具计算累积量，输入无洼地DEM生成的水流方向栅格，

【权重栅格】用于精细分配水量分配的大小（因为有些时候由于土壤降水等水流分配不一致）。默认为1

设置结果像元值拉伸类型为标准差看得清楚些

![image-20221029203029842](http://image.viotbery.cloud/image-20221029203029842.png)

### 水流长度

> 水流长度通常指地面上一点沿水流方向到其流向起点或终点的最大地面距离在水平面上的投影长度。
>
> 水流长度直接影响地面径流的速度进而影响对土壤的侵蚀力。

> 注意！所谓沿水流方向并不是说该店一定在一条水流上，由于导入的是流向栅格，所以在地面上任意一个像元都有自己的“流向”。具体见“汇流累积量”中图一的红色箭头。计算水流长度是指顺（或逆）着该箭头到流向起点的"距离"

使用【水流长度】工具分别计算顺流和溯流长度

![image-20221029204417885](http://image.viotbery.cloud/image-20221029204417885.png)

![image-20221029204458282](http://image.viotbery.cloud/image-20221029204458282.png)

- 使用 【上游】选项来完成计算给定盆地内最长水流的长度。该度量值常用于计算盆地的聚集时间。
- 该工具也可通过将权重栅格用作下坡运动的阻抗，来创建假设降雨和径流事件的距离-面积图。

### 河网的提取

#### 河网的生成

河流的形成是从地表径流汇聚而成的，这个过程正是‘汇流累积量’。因此对汇流累积量的结果栅格通过阈值划分，汇流量大于该阈值的设定为1，小于阈值的设定为无数据即可得到河网数据

![image-20221029205345728](http://image.viotbery.cloud/image-20221029205345728.png)

![image-20221029205608849](http://image.viotbery.cloud/image-20221029205608849.png)

再通过【栅格河网矢量化】结合流向数据生成河网矢量（这样可以得到带方向的线要素）

![image-20221029205657336](http://image.viotbery.cloud/image-20221029205657336.png)

<img src="http://image.viotbery.cloud/image-20221029211333373.png" alt="image-20221029211333373" style="zoom:33%;" />